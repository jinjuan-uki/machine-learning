# 模型选择与评估

> 作者：DZF  
>
> 邮箱：87257678@qq.com

  

## 经验误差与过拟合

* **误差**：学习器的实际预测输出与样本的真实输出之间的差异。
* **经验误差**：学习器在训练集上产生的误差。
* **范化误差**：学习器在新样本的上的误差。
* **过拟合**：学习器将训练样本中的一些特点当成了所有潜在样本的一般性质造成泛化性能下降的现象。
* **欠拟合**：学习器未能很好的学到训练样本中的一般性质。
  * 欠拟合可以通过增加模型复杂度、增加迭代轮次克服；
  * 过拟合无法真正克服，只能缓解，以减少其风险。

## 评估方法

### 留出法

* **留出法**：将数据集D直接划分为两个互斥的集合，其中一个称为训练集S，另一个称为测试集T。
  * 数据集划分应尽可能保持样本类别分布的一致性。
  * 从采样的角度来看，划分时实际是进行了分层采样。

* **注意**
  * 单次采用留出法进行评估结果往往不够可靠，一般要进行多次划分多次评估求其均值。
  * 由于测试集较小，评估结果可能不够稳定准确。

### 交叉验证法

* **交叉验证法**：将数据集划分为k个大小相似的互斥子集，尽量保证每个子集的分布一致，每次选取k-1个子集作为训练集，另一个子集作为测试集，从而获得k个训练/测试集，**k的常用取值是10**.
* **留一法**：不受随机样本划分的影响，每次选取一个样本进行测试，其余样本用于训练，是交叉验证的一种特例。

### 自助法

* **自助法**：以自助采样法（*bootstrapping*）为基础，数据集共有m个样本，每次从数据集D中有放回抽取一个样本，拷贝至D'中，重复m次，得到D'，样本在m次采样中不被采到的概率为1-1/m。
* 取极限，可得到未被采到的样本比例：

$$
lim (1-1/m) =1/e \approx0.368
$$

* 将D‘视为训练集，则测试集为D\D'，在测试集上的测试结果被称为**包外估计**。

* 由于自助采样法产生的数据集改变了初始数据集的分布情况，会引入估计偏差，因此在初始数据量充足时留出法和交叉验证法更为常用。

## 性能度量

### 回归中常用的度量方法

* **均方误差**：

$$
E(f;D)=\frac1m\Sigma_{i=1}^{m}(f(x_i)-y_i)^2
$$

* 对于数据分布的**均方误差**：

$$
E(f;D)=\int_{x\sim D}(f(x)-y)^2p(x)dx
$$

### 错误率与精度

* **错误率**：

$$
E(f;D)=\frac1m\Sigma_{i=1}^m\mathbb I(f(x_i)\not= y_i)
$$

$$
E(f;D)=\int_{x\sim D}\mathbb I(f(x_i)\not= y_i)p(x)dx
$$



* **精度**：

$$
acc(f;D)=\frac1m\Sigma_{i=1}^m\mathbb I(f(x_i)= y_i)=1-E(f;D)
$$

$$
acc(f;D)=\int_{x\sim D}\mathbb I(f(x_i)= y_i)p(x)dx
$$



### 查准率、查全率与F1

|                | 预测为正例 | 预测为负例 |
| -------------- | ---------- | ---------- |
| **真实为正例** | TP         | FN         |
| **真实为负例** | FP         | TN         |

* **查准率（precision）**：预测为正例中的实际为正例的占比。
  $$
  P=\frac{TP}{TP+FP}
  $$

* **查全率（recall）**：实际为正例的中被预测为正例的占比。
  $$
  R=\frac{TP}{TP+FN}
  $$

  * 查全率与查准率是一对**矛盾**，一个升高一个降低，如下图PR曲线所示，若一个学习器的PR曲线被另一个学习器完全包住，则后者性能优于前者。

![img](.\image\image1)

* **F1-Score**：平衡了PR，是PR的调和平均
  $$
  F1=\frac{2*P*R}{P+R}
  $$

### ROC与AUC

* **ROC**：受试者工作特征，按顺序逐个把样本作为正例进行预测，真正例率与假正例率形成的曲线。

  * **真正例率**：真实为正例的样本中被预测为正例的样本占比：

  $$
  TPR=\frac{TP}{TP+FN}
  $$

  * **假正例率**：真实为负例的样本中被预测为正例的样本占比：

  $$
  FPR=\frac{FP}{FP+TN}
  $$

* **AUC**：ROC曲线围成的下面积。

